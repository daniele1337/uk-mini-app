#!/bin/bash

echo "ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
echo "=========================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–æ–∫–µ–Ω
if [ -f ".env" ] && grep -q "TELEGRAM_BOT_TOKEN" .env; then
    echo "‚úÖ –¢–æ–∫–µ–Ω –±–æ—Ç–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ .env —Ñ–∞–π–ª–µ"
    echo "–¢–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω: $(grep TELEGRAM_BOT_TOKEN .env | cut -d'=' -f2)"
else
    echo "üìù –¢–æ–∫–µ–Ω –±–æ—Ç–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:"
    echo "–¢–æ–∫–µ–Ω: 8172377647:AAE6MS5TBL-tZKBWs1A3WPECef48cl_SgnU"
    BOT_TOKEN="8172377647:AAE6MS5TBL-tZKBWs1A3WPECef48cl_SgnU"
    
    if [ -n "$BOT_TOKEN" ]; then
        # –°–æ–∑–¥–∞–µ–º .env —Ñ–∞–π–ª
        echo "TELEGRAM_BOT_TOKEN=$BOT_TOKEN" > .env
        echo "‚úÖ –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ .env —Ñ–∞–π–ª–µ"
        
        # –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
        export TELEGRAM_BOT_TOKEN="$BOT_TOKEN"
        echo "‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
        
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
        echo "üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–æ—Ç—É..."
        RESPONSE=$(curl -s "https://api.telegram.org/bot$BOT_TOKEN/getMe")
        
        if echo "$RESPONSE" | grep -q '"ok":true'; then
            BOT_NAME=$(echo "$RESPONSE" | grep -o '"first_name":"[^"]*"' | cut -d'"' -f4)
            BOT_USERNAME=$(echo "$RESPONSE" | grep -o '"username":"[^"]*"' | cut -d'"' -f4)
            echo "‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!"
            echo "ü§ñ –ò–º—è –±–æ—Ç–∞: $BOT_NAME"
            echo "üë§ Username: @$BOT_USERNAME"
        else
            echo "‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–æ—Ç—É"
            echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞"
        fi
    else
        echo "‚ùå –¢–æ–∫–µ–Ω –Ω–µ –≤–≤–µ–¥–µ–Ω"
        exit 1
    fi
fi

echo ""
echo "üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
echo "1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: python app.py"
echo "2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å"
echo "3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è'"
echo "4. –ù–∞–∂–º–∏—Ç–µ '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞'"
echo "5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"
echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤–∞—à –±–æ—Ç –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
